import asyncio
import ssl
from asyncio import Semaphore, gather, run, wait_for

import aiofiles
import aiohttp
import certifi
from aiohttp.client import ClientSession

# Mock a list of different pdfs to download
pdf_list = set(["achagethumb.jpg", "abegra300.jpg", "Achillea salbeat300.jpg", "achfanthumbpc.jpg", "achillea feuer.jpg", "cormoon300.jpg", "Allium cepa Egyptian Walking Onion.jpg", "allsch300best.jpg", "allsenfullpc.jpg", "alltub300.jpg", "alotrigreeenanim copy.jpg", "altofffullpc.jpg", "ammala300.jpg", "aniflavyellowfullpc.jpg", "anttincbest300.jpg", "apios250.jpg", "aqucae2fullpc.jpg", "Aquilegia canadensis Eastern colombine 250.jpg", "aquchapfullpc.jpg", "aquchrfullpc.jpg", "ascincicefullpc.jpg", "ascincfullpc.jpg", "ascsyrfullpc.jpg", "ascphypodfullpc.jpg", "asctubfullpc.jpg", "asccurfullpc.jpg", "arttang.jpg", "artsativafullpc.jpg", "artsilkinfullpc.jpg", "bapaus300.jpg", "belchifruit300.jpg", "bolsnow300.jpg", "budglo300.jpg", "budsungol250.jpg", "camrad300.jpg", "caraca300.jpg", "carlonblu200.jpg", "catcae300.jpg", "catcaebicolor300.jpg", "cenrub300.jpg", "chalat250.jpg", "ciselm250.jpg", "cislad300.jpg", "cispur300.jpg", "cisxska250.jpg", "corlan250.jpg", "cortrip300.jpg", "cornusjay300.jpg", "cornusyelltwig300.jpg", "crocosyellow300.jpg", "cuphys300.jpg", "cymflex250.jpg", "diabathpnk250.jpg", "diabatred250.jpg", "diabriveil250.jpg", "diadaidame300.jpg", "diadot200.jpg", "diafire250.jpg", "diaglo250.jpg", "diagra250.jpg", "diainch300.jpg", "dialacrom250.jpg", "dialasgran250.jpg", "diaolitjock250.jpg", "dialondel200.jpg", "diamrssin3250.jpg", "diaoak250.jpg", "diaquesheba250.jpg", "diarosemai250.jpg", "echpar200.jpg", "Echinaceapur300.jpg", "echten200.jpg", "echexa200.jpg", "echsph200.jpg", "epiariz250.jpg", "epicalis300.jpg", "epidub300.jpg", "epiroghyb300.jpg", "epimatsel300.jpg", "eridark300.jpg", "erypla300.jpg", "eupcan300.jpg", "euppur300.jpg", "eupperf300.jpg", "filulm250.jpg", "foevul300.jpgbest", "fucpriora300.jpg", "fucche300.jpg", "fuchchilbea300.jpg", "fucmag250.jpg", "fucmagaur300.jpg", "fucmagtom300.jpg", "fucladear250.jpg", "fucthy150.jpg", "gaiprasun300.jpg", "gausowhi250.jpg", "germac250.jpg", "germag300.jpg", "gypbrifai300.jpg", "helautumn300.jpg", "hellemque250.jpg", "lavangbetblu250.jpg", "lavangbowear300.jpg", "lavbuevis250.jpg", "lavangchelseapink250.jpg", "lavangcomp300.jpg", "Lavandula angustifolia folgate 275.jpg", "lavanggrav300.jpg", "lavanggrayl300.jpg", "lavanghidcotebetblu250.jpg", "lavanghidpink300.jpg", "lavangiredoy300best.jpg", "lavangloblubest300.jpg", "maillette300.jpg", "lavangmarrod250.jpg", "lavangmelissa250.jpg", "lavangmiskat300good.jpg", "lavangnanalb150.jpg", "lavangprem250.jpg", "lavangpetpan300.jpg", "lavangros250.jpg", "lavangroyvel300.jpg", "lavangsach300.jpg", "lavangseal7oaks300.jpg", "lavangsharob300.jpg", "lavangsupblu300.jpg", "Tuckersearly300.jpg", "lavangtwipur300.jpg", "lavangvicame300.jpg", "lavxall150.jpg", "lavden250.jpg", "lavdencand250.jpg", "lavgoocre250.jpg", "lavvir300.jpg", "lavdenlind250.jpg", "lavxintabrial300.jpg", "lavxintalba150.jpg", "lavxintfrebou250.jpg", "lavxintgrosblu300.jpg", "lavxintgrosso300x.jpg", "lavxintimppur300.jpg", "lavxintlulcas300.jpg", "lavxintprov300.jpg", "lavxintstravon300.jpg", "lavxintprov300super copy.jpg", "lavstobal250.jpg", "lavstocurtop250.jpg", "lavstoivocro300.jpg", "lavstojamcom250.jpg", "lavstokew250.jpg", "lavstovangogh250.jpg", "lavstowillval250.jpg", "lavstowinnig300.jpg", "menchegum250.jpg", "menaqucitbeefly300.jpg", "pennyroyal.JPG", "menpep150.jpg", "Pineapple Mint (2).JPG", "menstraw300.jpg", "menwoolapp300best.jpg", "moncorreef250.jpg", "monjackli250.jpg", "monmenth300.jpg", "nepcatfinch250.jpg", "oriern250.jpg", "orikenbea300rock.jpg", "orilae250.jpg", "orilizhyb300best.jpg", "orixmarj250.jpg", "orisancru250.jpg", "orithegol250.jpg", "orivulcom250.jpg", "penalihin300.jpg", "penfire250best.jpg", "pencatlam300.jpg", "penidpink250.jpg", "penredtrum250.jpg", "penthor300.jpg", "penpurpas250.jpg", "penviokiss300.jpg", "penpin300.jpg", "penpinmeryl250.jpg", "phyyeltru300.jpg", "PHYAFRQUE300 BEST.jpg", "physen250.jpg", "privalhor250.jpg", "primah250.jpg", "priveryel250.jpg", "priveror250.jpg", "privul300.jpg", "rosladban300.jpg", "rosablunoi300.jpg", "rosgal300.jpg", "rosapegpin300.jpg", "rosalb300.jpg", "rosannahulka300best.jpg", "rosarp300.jpg", "rosbluboy300.jpg", "rosbluspi250.jpg", "rosbonjea200.jpg", "roscoling300best.jpg", "rosgor250.jpg", "roshercotlarge300.jpg", "rosladwhi300.jpg", "roslock300.jpg", "rosmajpink300best.jpg", "rosmoz300.jpg", "rosnanhow250.jpg", "rossawblu150.jpg", "rostusblu300.jpg", "salapi250.jpg", "salbledia250.jpg", "salbran300.jpg", "salbuc250.jpg", "salcac300.jpg", "salcle300.jpg", "salcoc300.jpg", "salcor250.jpg", "salelehon300jpg.jpg", "salelescapin300.jpg", "salgesteq250.jpg", "salgresal250.jpg", "salblablu300.jpg", "salindspi250.jpg", "salinv250.jpg", "saliod300.jpg", "salleuallpur250.jpg", "sallyrflwr300.jpg", "salmexmin300.jpg", "salmic250.jpg", "salwilwat250.jpg", "salgra300.jpg", "saloff300.jpg", "salviaberggarden300.jpg", "saloffict300.jpg", "saloffpur300.jpg", "salofftri300.jpg", "salsiesan250.jpg", "salscl300.jpg", "salulig300.jpg", "salver300.jpg", "salgrethe300.jpg", "salciendeoro250.jpg", "samcan300.jpg", "sanchaknot300.jpg", "sancharoyalknot300.jpg", "menhimsil300.jpg", "viomrsdav300.jpg", "violia150.jpg", "vioros300.jpg", "viofre250.jpg", "violab300.jpg", "vibtrifallfoliage300.jpg", "vibpru250.jpg", "thybroeng300.jpg", "thygolstr250.jpg", "thyleu300.jpg", "thylemfro300.jpg", "thymin300 copy.jpg", "thywoolly300.jpg", "thycrim300.jpg", "thyfreleafcrescent250.jpg", "thyorabaltopiary300.jpg", "tanvul300.jpg", "tanpar300.jpg", "achter300.jpg", "agatutfru250.jpg", "agafire300.jpg", "agarup300best.jpg", "agafoe300.jpg", "meadow arnica 2.JPG", "artabs250.jpg", "artvul300best.jpg", "asaspe300.jpg", "ascspeflowers250.jpg", "asccurcat251.jpg", "astcarbest300.jpg", "astpurdome300.jpg", "astprokip200.jpg", "astmonch300.jpg", "giftcertfull1.jpg", "launobtop300.jpg", "verbon250.jpg", "verbhas300.jpg", "cyncar250.jpg", "humlup300.jpg", "humlupaur300.jpg", "hydmarper250.jpg", "hydnikblu250.jpg", "hydpeegee250.jpg", "hypperfull.JPG", "inuens250.jpg", "knicau250.jpg", "lobcar300best.jpg", "rutgracaprilands300.jpg", "irisger300.jpg", "dollies250.jpg", "notecards200set1.jpg", "notecards200set2.jpg", "altoff300.jpg", "elfinthymusfre300.jpg", "salleuwhi300best.jpg", "moncat2 copy.jpg", "pelmabgre300.jpg", "ascspepod300.jpg", "ascsyr300.jpg", "opuhum300.jpg", "petjapquebec300.jpg", "phlfru150.jpg", "peratr250.jpg", "phyvirviv300.jpg", "ribsan250.jpg", "rhutyp300.jpg", "rudgold250.jpg", "rudtri250.jpg", "thypaspin250.jpg", "mimcar300.jpg", "liaspi300.jpg", "scullcap 2.JPG", "teufruazu300.jpg", "saloffros250.jpg", "pelbourossil250.jpg", "pelbrun250.jpg", "pelcop250.jpg", "Pelargonium Cispum Major 250.jpg", "pelcyssun300.jpg", "pelendoak225.jpg", "pelfaiellt225.jpg", "pelgollemon250.jpg", "pelgraylady300.jpg", "pelpea250.jpg", "peltomtrellis250.jpg", "pelgrav300x.jpg", "pellemon250.jpg", "pelstagpep250.jpg", "silrouros225.jpg", "Nettles 250.jpg", "verhomeste250.jpg", "veroldroy250.jpg", "tulvio250.jpg", "teucha300.jpg", "bookeverlastings200.jpg", "bookgourdsorgan300.jpg", "bookfernstofost300.jpg", "bookforprofi400.jpg", "bookginseng400.jpg", "bookherbs300.jpg", "knipribeafull250.jpg", "sangreen300 copy.jpg", "satmonknot250.jpg", "scrcal300.jpg", "staafffull.JPG", "achmilpro150.jpg", "crocosred300.jpg", "lobsipblue300.jpg", "lobsipalba300.jpg", "lavgoocregdn300best.jpg", "sweetrbraid250.jpg", "agreup300.jpg", "alchxan300.jpg", "lavangceleststar300.jpg", "Elizabeth300.jpg", "lavxintcatb200.jpg", "Avicehill350.jpg", "2 Lavandula angustifolia Melissa Lilac 250.jpg", "lavhetero150.jpg", "rosporpin300.jpg", "globe artichoke.JPG", "spearmint3.JPG", "lovage 300.jpg", "pacificBlue300.jpg", "goldenrod 250.jpg", "EgertonBlue300.jpg", "Pelargonium Apricot fool 250.JPG", "lavandula Purple Bouquet 275.jpg", "lavenite petite 250.jpg", "NewZealandBlue300.jpg", "Goodwin Creek Oregano 250.jpg", "lavandula sussex 250.jpg", "IMG_2022-10-22-160509.jpg", "Sumian300.jpg", "mabel gray pelargonium scented geranium 300.jpg", "pretty polly scented geranium pelarg 300.jpg", "ginger scented torento geranium pelarg 300.jpg", "orange scented pelargonium 300.jpg", "achagethumb.jpg", "abegra150.jpg", "acamolthumbpc.jpg", "Achilleasalbeauty150.jpg", "achfanthumbpc.jpg", "IMG_2022-10-23-112402.jpg", "achlilbeathumbpc.jpg", "cormoon150.jpg", "allcepa150.jpg", "allcerthumbpc.jpg", "allfisthumbpc.jpg", "allschthumbpc.jpg", "allsenthumbpc.jpg", "alltub150.jpg", "alotriithumbpc.jpg", "altoffthumbpc.jpg", "ammalathumbpc.jpg", "aniflathumbpc.jpg", "anttin150.jpg", "apiosthumbpc.jpg", "aqucaethumbpc.jpg", "Aquilegia canadensis Eastern colombine 150.jpg", "aquchapthumbpc.jpg", "aquchrthumbpc.jpg", "aquforthumbpc.jpg", "ascincicethumbpc.jpg", "ascincthumbpc.jpg", "ascsyrthumbpc.jpg", "ascphythumbpc.jpg", "asctubthumbpc.jpg", "asccurthumbpc.jpg", "arttan150.jpg", "artsativathumbpc.jpg", "artsilkinthumbpc.jpg", "bapauspod150.jpg", "belchi150.jpg", "bolsnow150.jpg", "budglo150.jpg", "budsungol150.jpg", "camrad150.jpg", "caraca150.jpg", "carlonblu150.jpg", "catcae150.jpg", "catcaebicolor150.jpg", "cenrub150.jpg", "chalat150.jpg", "ciselm150.jpg", "cislad150.jpg", "cispur150.jpg", "ciisskan150.jpg", "corlan150.jpg", "cortrip150.jpg", "corsto150.jpg", "cornusyelltwig150.jpg", "crocosyellow150.jpg", "cuphys150.jpg", "cymfle150.jpg", "diabathpnk150.jpg", "diabatred150.jpg", "diabriveil150.jpg", "diadaidame150.jpg", "diadot150.jpg", "diafire150.jpg", "diaglo150.jpg", "diagra150.jpg", "newcolorlogo150 text.jpg", "diainch150.jpg", "dialacrom150.jpg", "dialadgran150.jpg", "dialitjock150.jpg", "dialondel150.jpg", "diamrssin150.jpg", "diaoak150.jpg", "diaquesheba150.jpg", "diarosema150.jpg", "echpar150.jpg", "Echinaceapur150.jpg", "echten150.jpg", "echexa150.jpg", "echsph150.jpg", "epiariz150.jpg", "epicalis150.jpg", "epidub150.jpg", "epiroghyb150.jpg", "epimatsel150.jpg", "eridark150.jpg", "erypla150.jpg", "eupcan150.jpg", "euppur150.jpg", "eupperf150.jpg", "filulm150.jpg", "foevul150.jpg", "fucpriora150.jpg", "fucche150.jpg", "fuchchilbea150.jpg", "fucmag150.jpg", "fucmagau150.jpg", "fucmagtom150.jpg", "fuctricolor150.jpg", "fucladear150.jpg", "fucthy150.jpg", "gaiprasun150.jpg", "gausowhi150.jpg", "germac150.jpg", "germag150.jpg", "gypbrifai150.jpg", "helautum150.jpg", "hellemque150.jpg", "lavangbablu150.jpg", "lavangbetblu150.jpg", "lavangbowear150.jpg", "lavbuevis150.jpg", "lavangchelseapink150.jpg", "lavangcomp150.jpg", "Lavandula angustifolia folgate 150.jpg", "lavanggrav150best.jpg", "lavanggrayl150.jpg", "lavanghidcote150betblu.jpg", "lavanghidpink150.jpg", "IreneDoyle150.jpg", "lavanglodblu150.jpg", "maillette.jpg", "lavangmarrod150.jpg", "lavangmelissa150.jpg", "lavangmisskat150.jpg", "lavangnanalb150.jpg", "lavangprem150.jpg", "lavangpetpan150.jpg", "lavangros150.jpg", "lavangroyvel150.jpg", "lavangsach150.jpg", "lavangseal7oaks150.jpg", "SharonRobert150.jpg", "lavangsupblu150.jpg", "TuckersEarly150.jpg", "lavangtwipur150.jpg", "lavangvicame.jpg", "lavmult150.jpg", "lavden150.jpg", "lavdencand150.jpg", "lavgoocre150.jpg", "lavvir150.jpg", "lavdenlinda150.jpg", "lavxintabrial150.jpg", "lavxintalb150.jpg", "lavxintgrosblu150.jpg", "lavxintgrosso150x.jpg", "lavxintimppur150best.jpg", "lavxintlulcas150.jpg", "lavxintprov150best.jpg", "lavxintsoavon150.jpg", "lavxintprov150supercopy.jpg", "lavstobal150.jpg", "lavstocurtop150.jpg", "lavstoivocro150.jpg", "lavstojamcom150.jpg", "lavstokew150.jpg", "lavstovangog150.jpg", "lavstowillval150.jpg", "lavstowinnig150.jpg", "menchegum150.jpg", "mencho150.jpg", "mencurled150.jpg", "mengrap150.jpg", "mencitrat150poor.jpg", "pennyroyal mint.jpg", "menpep150.jpg", "Pineapple mint.jpg", "menstraw150.jpg", "menwooapp150.jpg", "moncorreef150.jpg", "monjackli150.jpg", "monmen150.jpg", "nepcatfinch150.jpg", "oriern150.jpg", "orikal150.jpg", "orikenbea150.jpg", "orilae150.jpg", "orilizhyb150best.jpg", "orixmar150.jpg", "orisancru150.jpg", "orithegol150.jpg", "orivulcom150.jpg", "penalihin150.jpg", "peneve150.jpg", "penfire150best.jpg", "pencatlam150.jpg", "penhidpin150.jpg", "penredtrum150.jpg", "pentho150.jpg", "penpurpas150.jpg", "penviokis150.jpg", "penpin150.jpg", "penpinmeryel150.jpg", "phyyeltru150.jpg", "phyafrque150.jpg", "physen150.jpg", "privalhor150.jpg", "primah150.jpg", "priveryel150.jpg", "priveror150.jpg", "privul150.jpg", "rosladban150ok.jpg", "rosablunoi150.jpg", "rosgal150.jpg", "rosapegpin150.jpg", "rosalb150.jpg", "rosannahulka150best.jpg", "rosarp150.jpg", "rosbluboy150.jpg", "rosbluspi150.jpg", "rosbonjea150.jpg", "roscoling150.jpg", "rosgor150.jpg", "roshercotflower150.jpg", "rosladwhi150.jpg", "roslock150.jpg", "rosmajpink150best.jpg", "rosmoz150.jpg", "rosnanhow150.jpg", "rossawblu150.jpg", "rostuscanblu.jpg", "salapi150.jpg", "salbledia150.jpg", "salbran150.jpg", "salbuc150.jpg", "salcac150.jpg", "salcle150.jpg", "salcoc150.jpg", "salcor150.jpg", "salelehon150.jpg", "salelescapin150.jpg", "salgesteq150.jpg", "salgregsal150.jpg", "salblablu150.jpg", "salindspi150.jpg", "salinv150.jpg", "saliod150.jpg", "salleuallpur150.jpg", "sallyrfol150.jpg", "salmexmin150.jpg", "salmic150.jpg", "salwilwat150.jpg", "salgra150.jpg", "saloff150.jpg", "saloffberg150.jpg", "saloffict150.jpg", "saloffpur150.jpg", "salofftri150.jpg", "salsiesan150.jpg", "salscl150.jpg", "salulig150.jpg", "salver150.jpg", "salgrethe150.jpg", "salciendeoro150.jpg", "samcan150.jpg", "sancha150.jpg", "sanchapre150.jpg", "menhimsil150.jpg", "viomrsdav150.jpg", "vioros150.jpg", "viofre150.jpg", "violab150.jpg", "vibtrisnow150.jpg", "vibprurobin150.jpg", "thybroeng150.jpg", "thygol150.jpg", "thyleu150.jpg", "thylemfro150.jpg", "thymin150.jpg", "thywoolly.jpg", "thycrim150.jpg", "thyfreleafcrescen150.jpg", "thyorabal150.jpg", "tanvul150.jpg", "tanpar150.jpg", "achter150.jpg", "agatutfru150.jpg", "agafire150best.jpg", "agarup150.jpg", "agafoe150.jpg", "newcolorlogo150.jpg", "Meadow arnica 1.jpg", "artabs150.jpg", "artvul150best.jpg", "asaspe150.jpg", "ascspepods150.jpg", "ascsilgold150.jpg", "astcarbest150.jpg", "astpurdome150.jpg", "astprokip150.jpg", "astmonch150.jpg", "giftcertfull1.jpg", "launob150.jpg", "verbon150.jpg", "verbhas150.jpg", "cyncar150.jpg", "helital150.jpg", "humlup150ok.jpg", "humlupaur150.jpg", "hydmarper150.jpg", "hydnikblu150.jpg", "hydgrapeegee150.jpg", "hypperthumb.JPG", "inuens150.jpg", "knicau150.jpg", "lobcar150best.jpg", "rue150.jpg", "Orris root potted plant.jpg", "dollies150.jpg", "starflwrsingle150.jpg", "centsingle150.jpg", "echpur150.jpg", "moneupcanab150.jpg", "penkunth150.jpg", "foevulcat150.jpg", "pelbourossil150.jpg", "ascspepod150.jpg", "ascsyr150.jpg", "opuhum150.jpg", "petjap150.jpg", "phlfru150.jpg", "peratrf150.jpg", "phyvir150.jpg", "ribsan150.jpg", "rhutyp150.jpg", "rudgold150.jpg", "rudtri150.jpg", "thypaspin150.jpg", "mimcar150.jpg", "liaspi150.jpg", "Scullcap 1.JPG", "teufruazu150.jpg", "saloffros150.jpg", "pelsilapple150x.jpg", "pelbrun150x.jpg", "pelsilcop150.jpg", "Pelargonium Cispum Major 150.jpg", "pelcyssu 150.jpg", "pelendoak150.jpg", "pelfaiell150.jpg", "pelgollemon150.jpg", "pelgraylady150.jpg", "pelpea150.jpg", "siltomen.JPG", "pelgrav150x.jpg", "pellemon150.jpg", "pelstagpep150.jpg", "silrouros150.jpg", "Nettles 155.jpg", "verhomeste150.jpg", "veroldroy150.jpg", "tulviotriflow150.jpg", "tulvio150.jpg", "teucha150.jpg", "bookeverlastings125.jpg", "bookgourdsorgan150.jpg", "bookfernstofost150.jpg", "bookforprofit159.jpg", "bookginsng150.jpg", "bookherbs150.jpg", "knipribeathumb150.jpg", "sangreen150.jpg", "satmon150.jpg", "scrcal150.jpg", "staaff150.jpg", "achmilpro150.jpg", "crocosred150.jpg", "lobsipblue150.jpg", "lobsipalba150.jpg", "sweetbraid150.jpg", "acoruslic150.jpg", "acorusogon150.jpg", "agreup150.jpg", "alcxan150.jpg", "lavangceleststar150.jpg", "lavangcoconuticemelisa150.jpg", "Elizabeth150.jpg", "lavxintcatb150.jpg", "Avicehill150.jpg", "Lavandula angustifolia Melissa Lilac 150.jpg", "lavhetero150.jpg", "rosporpin150.jpg", "globe artichoke 1.jpg", "spearmint4.jpg", "lovage better.jpg", "PacificBlue150.jpg", "Image Coming Soon thumbnail.png", "goldenrod 150.jpg", "EgertonBlue150.jpg", "imperial gem 150.jpg", "Lavandula angustifolia Princess Blue 150.jpg", "Pelargonium Apricot Fool 150 new.jpg", "lavandula Purple Bouquet.jpg", "lavenite petite 150.jpg", "IMG_2022-10-22-152450.jpg", "Goodwin Creek oregano 150.jpg", "lavandula sussex 150.jpg", "Silver grey 100.jpg", "Sumian100.jpg", "mabel gray pelargonium scented geranium 150.jpg", "Pretty Polly scented geranium pelarg 150.jpg", "ginger scented torento geranium pelarg 150.jpg", "orange scented pelargonium 150.jpg"])
url = 'https://www.goodwincreekgardens.com/images/products/'

MAX_TASKS = 10
MAX_TIME = 50000

async def download(pdf_list):
    tasks = []
    sem = Semaphore(MAX_TASKS)
    ssl_context = ssl.create_default_context(cafile=certifi.where())
    conn = aiohttp.TCPConnector(ssl=ssl_context)
    async with ClientSession(connector=conn) as sess:
        for pdf_url in pdf_list:
            # Mock a different file name each iteration
            dest_file = "new_images/" + pdf_url
            new_url = url + pdf_url
            tasks.append(
                # Wait max 5 seconds for each download
                wait_for(
                    download_one(new_url, sess, sem, dest_file),
                    timeout=MAX_TIME,
                )
            )
        return await gather(*tasks)


async def download_one(url, sess, sem, dest_file):
    async with sem:
        print(f"Downloading {url}")
        async with sess.get(url) as res:
            content = await res.read()

        # Check everything went well
        if res.status != 200:
            print(f"Download failed: {url}")
            return

        async with aiofiles.open(dest_file, "+wb") as f:
            await f.write(content)
            # No need to use close(f) when using with statement


if __name__ == "__main__":
    asyncio.set_event_loop_policy(asyncio.WindowsSelectorEventLoopPolicy())
    run(download(pdf_list))
